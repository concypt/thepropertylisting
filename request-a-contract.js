"use strict";(()=>{console.log("ppapi chooooolo");var i=document.querySelector('[data-element="Purchaser"]');i==null||i.addEventListener("change",n=>{n.preventDefault();let t=n.target.value,e=document.querySelector('[data-purchaser="Joint"]');t==="Joint"&&(e==null||e.classList.remove("hide")),t==="Single"&&(e==null||e.classList.add("hide"))});var d=document.querySelector('[data-element="Buying Entity Type"]');d==null||d.addEventListener("change",n=>{n.preventDefault();let t=n.target.value,e=document.querySelector('[data-element="Buying Entity Name"]');t!=="Named above"&&(e==null||e.classList.remove("hide")),(t==="Named above"||t==="")&&(e==null||e.classList.add("hide"))});var k=[];document.querySelectorAll('[data-element="listing-item"]').forEach(n=>{var c,s;let t=(c=n.querySelector('[data-element="listing-address"]'))==null?void 0:c.textContent,e=(s=n.querySelector('[data-element="listing-airtable"]'))==null?void 0:s.textContent,o={address:t,airtable:e};o&&k.push(o)});var m=new autoComplete({placeHolder:"Search for listing...",data:{src:k,keys:["address"],cache:!0},resultItem:{highlight:!0},events:{input:{selection:n=>{let t=n.detail.selection.value;m.input.value=t}}}}),x;(x=document.querySelector("#autoComplete"))==null||x.addEventListener("selection",function(n){let t=n.detail;m.input.blur();let e=t.selection.value[t.selection.key];m.input.value=e;let o=t.selection.value.airtable;H(o).then(c=>M(c))});async function H(n){let t="https://api.airtable.com/v0/appWNf6XfqAR6n0oT/"+n+"?api_key=keyUxdcC40qxNrt1Y";return await(await fetch(t)).json()}var M=n=>{let t=document.querySelector('[data-element="AvailableUnits"]');if(!t)return;let e=t.options.length-1,o;for(o=e;o>=1;o--)t.remove(o);let c=n.records,s=[];c.forEach(a=>{let r="Unit "+a.fields["Unit/Lot"]+" - $"+U(a.fields.Price)+" / "+(a.fields.Land?a.fields.Land:"")+(a.fields.Land?"sqm / ":"")+a.fields.Beds+" / "+a.fields.Baths+" / "+a.fields["Car Park"];s.push(r)}),s.sort(J),s.forEach(a=>{let r=document.createElement("option");r.text=a+"",r.value=a+"",t==null||t.add(r)})},A="a95d779bec144d448ebcafccdec4ce61";function E(){let n=new AddyComplete(document.getElementById("main-address"));n.options.excludePostBox=!1,n.fields={address1:document.getElementById("main-address"),address2:document.getElementById("main-address2"),city:document.getElementById("main-city"),postcode:document.getElementById("main-postcode"),suburb:document.getElementById("main-suburb")}}(function(n,t){let e=n.createElement("script"),o="https://www.addysolutions.com/address-lookup/1.6.2/js/addy.min.js";e.src=o+"?loadcss=true&enableLocation=false&country=nz&nzKey="+A,e.type="text/javascript",e.async=1,e.onload=E,n.body.appendChild(e)})(document,window);var u=(n,t,e)=>{let o=n==null?void 0:n.cloneNode(!0),c=o.querySelector("span"),s=o.querySelector("input");if(!(!c||!s))return c.textContent=t.toString(),s.value=e.toString(),o},B=(n,t,e)=>{let o=t==null?void 0:t.parentElement;t==null||t.remove(),n.forEach((c,s,a)=>{var f,y,h,L,p,g,S,v;let r=c,I="Yes - "+((f=r.querySelector('[data-element="'+e+' Location"]'))==null?void 0:f.textContent)+(e!=="Lawyer"?" ":": ")+((y=r.querySelector('[data-element="'+e+' Name"]'))==null?void 0:y.textContent)+" at "+((h=r.querySelector('[data-element="'+e+' Firm"]'))==null?void 0:h.textContent)+" ("+((L=r.querySelector('[data-element="'+e+' Email"]'))==null?void 0:L.textContent)+" / "+((p=r.querySelector('[data-element="'+e+' Phone"]'))==null?void 0:p.textContent)+" )",R=((g=r.querySelector('[data-element="'+e+' Location"]'))==null?void 0:g.textContent)+": "+((S=r.querySelector('[data-element="'+e+' Name"]'))==null?void 0:S.textContent)+" at "+((v=r.querySelector('[data-element="'+e+' Firm"]'))==null?void 0:v.textContent);if(t){let C=u(t,I,R);if(C&&(o==null||o.append(C)),s===a.length-1){let l;e==="Lawyer"?l=u(t,"No - please fill in purchaser solicitors section below","Custom Lawyer"):l=u(t,"No - please fill in purchaser broker section below","Custom Broker"),l&&(o==null||o.append(l));let q=o==null?void 0:o.querySelector(".w-form-formradioinput:first-child");q&&(q.checked=!0)}}})},N=document.querySelectorAll('[data-element="Lawyer Item"]'),w=document.querySelector('[data-element="Lawyer Radio"]');w&&B(N,w,"Lawyer");var D=document.querySelectorAll('[data-element="Broker Item"]'),b=document.querySelector('[data-element="Broker Radio"]');b&&B(D,b,"Broker");document.addEventListener("click",function(n){var e,o,c,s;let t=n.target;t.classList.contains("lawyer-radio")&&(t.value==="Custom Lawyer"?(e=document.querySelector('[data-element="Custom Lawyer"]'))==null||e.classList.remove("hide"):(o=document.querySelector('[data-element="Custom Lawyer"]'))==null||o.classList.add("hide")),t.classList.contains("broker-radio")&&(t.value==="Custom Broker"?(c=document.querySelector('[data-element="Custom Broker"]'))==null||c.classList.remove("hide"):(s=document.querySelector('[data-element="Custom Broker"]'))==null||s.classList.add("hide"))});function U(n){return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function J(n,t){let e=[],o=[];for(n.replace(/(\d+)|(\D+)/g,function(c,s,a){e.push([s||1/0,a||""])}),t.replace(/(\d+)|(\D+)/g,function(c,s,a){o.push([s||1/0,a||""])});e.length&&o.length;){let c=e.shift(),s=o.shift(),a=c[0]-s[0]||c[1].localeCompare(s[1]);if(a)return a}return e.length-o.length}})();
